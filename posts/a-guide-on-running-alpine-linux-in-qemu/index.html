<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>A Guide on Running Alpine Linux in QEMU - yuankun@net: ~$</title><meta name=Description content="Always do what you're afraid to do"><meta property="og:title" content="A Guide on Running Alpine Linux in QEMU"><meta property="og:description" content="How to run a Linux operating system in QEMU."><meta property="og:type" content="article"><meta property="og:url" content="https://yuankun.me/posts/a-guide-on-running-alpine-linux-in-qemu/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-14T09:41:41+08:00"><meta property="article:modified_time" content="2020-03-14T09:41:41+08:00"><meta property="og:site_name" content="yuankun@net: ~$"><meta name=twitter:card content="summary"><meta name=twitter:title content="A Guide on Running Alpine Linux in QEMU"><meta name=twitter:description content="How to run a Linux operating system in QEMU."><meta name=application-name content="yuankun@net: ~$"><meta name=apple-mobile-web-app-title content="yuankun@net: ~$"><meta name=theme-color content="#f8f8f8"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=canonical href=https://yuankun.me/posts/a-guide-on-running-alpine-linux-in-qemu/><link rel=prev href=https://yuankun.me/posts/publishing-subdirectory-to-github-pages/><link rel=next href=https://yuankun.me/posts/running-the-raw-linux-kernel-in-qemu/><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"A Guide on Running Alpine Linux in QEMU","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yuankun.me\/posts\/a-guide-on-running-alpine-linux-in-qemu\/"},"genre":"posts","keywords":"linux, qemu","wordcount":495,"url":"https:\/\/yuankun.me\/posts\/a-guide-on-running-alpine-linux-in-qemu\/","datePublished":"2020-03-14T09:41:41+08:00","dateModified":"2020-03-14T09:41:41+08:00","publisher":{"@type":"Organization","name":"yuankun"},"author":{"@type":"Person","name":"yuankun"},"description":""}</script><script src=//instant.page/5.2.0 defer type=module integrity=sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z></script></head><body header-desktop header-mobile><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else""==="light"||""==="dark"||""==="black"?(setTheme(""),saveTheme("")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="yuankun@net: ~$">yuankun@net: ~$</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Blog </a><a class=menu-item href=/about/>About </a><a class=menu-item href=/syscall64/>Linux x64 Syscalls </a><a class=menu-item href=/syscall32/>Linux x32 Syscalls </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="yuankun@net: ~$">yuankun@net: ~$</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Blog</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/syscall64/ title>Linux x64 Syscalls</a><a class=menu-item href=/syscall32/ title>Linux x32 Syscalls</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><article class="page single"><h1 class="single-title animate__animated animate__flipInX">A Guide on Running Alpine Linux in QEMU</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class="author fas fa-user-circle fa-fw"></span><a href=/ title=Author rel=author class=author>yuankun</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-03-14>2020-03-14</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2020-03-14>2020-03-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;495 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div></div><div class=content id=content><p>How to run a Linux operating system in QEMU.</p><h2 id=a-very-brief-introduction-to-qemu class=headerLink><a href=#a-very-brief-introduction-to-qemu class=header-mark></a>A Very Brief Introduction to QEMU</h2><p><a href=https://www.qemu.org target=_blank rel="noopener noreferrer">QEMU</a> (Quick EMUlator) is a generic and open source machine emulator originally developed by <a href=https://bellard.org/ target=_blank rel="noopener noreferrer">Fabrice Bellard</a> (this same guy is also the original author of FFMPEG, insanely). It is a powerful and versatile tool that has gained widespread recognition and adoption in the world of virtualization. It provides a platform for creating and managing virtual machines, enabling users to emulate various hardware architectures, operating systems, and software environments.</p><p>One of the notable features of QEMU is its ability to provide full system emulation, allowing users to run unmodified guest operating systems on different host platforms. Additionally, QEMU supports a variety of virtualization techniques, such as hardware-assisted virtualization (e.g., Intel VT-x, AMD-V) and software based emulation, providing a range of options for running virtual machines efficiently.</p><p>QEMU also includes a suite of user-level emulation modes, enabling users to run software applications compiled for a different architecture without the need for complete system emulation. This feature is particularly useful for software developers who need to test their applications on different platforms without the overhead of running a full virtual machine.</p><p>Furthermose, QEMU integrates with the popular KVM hypervisor on Linux, allowing it to take advantages of hardware virtualization extensions and deliver near-native performance for virtualized workloads. This combination of QEMU and KVM has become a robust and widely adopted solution for virtualization in cloud computing environments.</p><h2 id=running-alpine-linux-in-qemu class=headerLink><a href=#running-alpine-linux-in-qemu class=header-mark></a>Running Alpine Linux in QEMU</h2><p>Let&rsquo;s start by downloading the Alpine Linux installation media.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=nv>ALPINE_VERSION</span><span class=o>=</span>v3.11.3
</span></span><span class=line><span class=cl>wget <span class=s2>&#34;http://dl-cdn.alpinelinux.org/alpine/</span><span class=si>${</span><span class=nv>ALPINE_VERSION</span><span class=p>%.*</span><span class=si>}</span><span class=s2>/releases/x86_64/alpine-standard-</span><span class=si>${</span><span class=nv>ALPINE_VERSION</span><span class=si>}</span><span class=s2>-x86_64.iso&#34;</span>
</span></span></code></pre></div><p>Next, we craft a virtual hard drive for out Linux virtual machine. QEMU supports a long <a href=https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/virtualization_deployment_and_administration_guide/sect-using_qemu_img-supported_qemu_img_formats target=_blank rel="noopener noreferrer">list of image formats</a>. Among those, qcow2 is the most versatile format with the best feature set. We are going to use qcow2 format for our virtual machine.</p><p>We declare the size to be 10G, but note that only the written sectors will reserve space. The actual size of this file is much smaller.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ qemu-img create -f qcow2 alpine.qcow2 10G
</span></span></code></pre></div><p>Having ticked off the preparation checklist, we can now boot the installation media.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ qemu-system-x86_64 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -enable-kvm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -m <span class=m>2048</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -smp <span class=nv>cores</span><span class=o>=</span>2,threads<span class=o>=</span><span class=m>4</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -nic user <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -drive <span class=nv>file</span><span class=o>=</span>alpine.qcow2,media<span class=o>=</span>disk <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -cdrom alpine-standard-3.11.3-x86_64.iso
</span></span></code></pre></div><p>The options are explained as:</p><ul><li><code>-enable-kvm</code>: Utilizes KVM when running a target architecture that mirrors the host architecture, allowing the guest machine to take advantage of KVM acceleration.</li><li><code>-m 2048</code>: Allocates 2GB memory to the guest machine.</li><li><code>-smp cores=2,threads=4</code>: Specify the number of CPU cores and threads to utilize.</li><li><code>-nic user</code>: Appends a virtual network interface controller to the guest machine. Learn more in this <a href=https://www.qemu.org/2018/05/31/nic-parameter/ target=_blank rel="noopener noreferrer">article</a>.</li><li><code>-drive file=alpine.qcow2,media=disk</code>: Attaches the newly created virtual hard drive to guest machine. The virtual hard drive will be mounted at <code>/dev/vda</code>.</li><li><code>-cdrom alpine-standard-3.11.3-x86_64.iso</code>: Attaches a virtual CDROM drive and loads the Alpine Linux installation media into it.</li></ul><p>Post the Alpine installation onto the hard drive, booting can be proceed without the <code>-cdrom</code> option.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ qemu-system-x86_64 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -enable-kvm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -m <span class=m>2048</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -nic user <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -drive <span class=nv>file</span><span class=o>=</span>alpine.qcow2,media<span class=o>=</span>disk
</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2020-03-14</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/linux/>linux</a>,&nbsp;<a href=/tags/qemu/>qemu</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/publishing-subdirectory-to-github-pages/ class=prev rel=prev title="Publishing Subdirectory to Github Pages"><i class="fas fa-angle-left fa-fw"></i>Publishing Subdirectory to Github Pages</a>
<a href=/posts/running-the-raw-linux-kernel-in-qemu/ class=next rel=next title="Running the Raw Linux Kernel in QEMU">Running the Raw Linux Kernel in QEMU<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.112.7">Hugo</a>&nbsp;|&nbsp;Theme - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreferrer" title="DoIt 0.3.0"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer">yuankun</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"comment",lightTheme:"github-light",repo:"yuankunzhang/blog"}}}</script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/js/theme.min.js defer></script><script type=text/javascript src=/js/utterances.min.js defer></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZXQSK4ST20")</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-ZXQSK4ST20" async></script></div></body></html>