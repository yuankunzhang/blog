<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">
<meta itemprop="name" content="GCP IPs All Appear in US, and It Has Been Marked as Intended Behavior">
<meta itemprop="description" content="As you may have already known, all the IPs of Google Cloud Platform share the same geolocation, which is the US. This buggy thing has been marked as &ldquo;intended behavior&rdquo;, so no fix would be expected in the future. Even ironically, the guy who raised this issue was &ldquo;kindly advised&rdquo; to contact Google&rsquo;s legal department. Here is the issue ticket.
Dear Google, when people create a network in a chosen region, they expect the public IPs of the network to be in that region.">
<meta itemprop="datePublished" content="2020-03-22T23:12:59&#43;08:00" />
<meta itemprop="dateModified" content="2020-03-24T00:29:28&#43;08:00" />
<meta itemprop="wordCount" content="379">



<meta itemprop="keywords" content="gcp," /><meta property="og:title" content="GCP IPs All Appear in US, and It Has Been Marked as Intended Behavior" />
<meta property="og:description" content="As you may have already known, all the IPs of Google Cloud Platform share the same geolocation, which is the US. This buggy thing has been marked as &ldquo;intended behavior&rdquo;, so no fix would be expected in the future. Even ironically, the guy who raised this issue was &ldquo;kindly advised&rdquo; to contact Google&rsquo;s legal department. Here is the issue ticket.
Dear Google, when people create a network in a chosen region, they expect the public IPs of the network to be in that region." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuankun.me/posts/gcp-ips-all-appear-in-us-and-it-has-been-marked-as-intended-behavior/" />
<meta property="article:published_time" content="2020-03-22T23:12:59+08:00" />
<meta property="article:modified_time" content="2020-03-24T00:29:28+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="GCP IPs All Appear in US, and It Has Been Marked as Intended Behavior"/>
<meta name="twitter:description" content="As you may have already known, all the IPs of Google Cloud Platform share the same geolocation, which is the US. This buggy thing has been marked as &ldquo;intended behavior&rdquo;, so no fix would be expected in the future. Even ironically, the guy who raised this issue was &ldquo;kindly advised&rdquo; to contact Google&rsquo;s legal department. Here is the issue ticket.
Dear Google, when people create a network in a chosen region, they expect the public IPs of the network to be in that region."/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>GCP IPs All Appear in US, and It Has Been Marked as Intended Behavior</title>
	<link rel="stylesheet" href="https://yuankun.me/css/style.min.657bcb7af31123e4156b1a3d2ff60a636717e54ead74f882136b5114cf72b55e.css" integrity="sha256-ZXvLevMRI+QVaxo9L/YKY2cX5U6tdPiCE2tRFM9ytV4=" crossorigin="anonymous">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://yuankun.me/">Yuankun&#39;s Blog</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://yuankun.me/posts/">$ ls -l posts/</a>
				<a href="https://yuankun.me/whoami/">$ whoami</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://github.com/yuankunzhang" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="https://www.linkedin.com/in/yuankun-zhang-b1415b116/" target="_blank" rel="noopener me" title="Linkedin"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="https://stackoverflow.com/users/756651/yuankun" target="_blank" rel="noopener me" title="Stackoverflow"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2.913 16.041v6.848h17.599v-6.848M7.16 18.696h8.925M7.65 13.937l8.675 1.8M9.214 9.124l8.058 3.758M12.086 4.65l6.849 5.66M15.774 1.111l5.313 7.162"/></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://yuankun.me/posts/">$ ls -l posts/</a></li>
			<li><a href="https://yuankun.me/whoami/">$ whoami</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Mar 22, 2020</span></div>
				<h1>GCP IPs All Appear in US, and It Has Been Marked as Intended Behavior</h1>
			</header>
			<div class="content">
				<p>As you may have already known, all the IPs of Google Cloud Platform share the same geolocation, which is the US. This buggy thing has been marked as &ldquo;intended behavior&rdquo;, so no fix would be expected in the future. Even ironically, the guy who raised this issue was &ldquo;kindly advised&rdquo; to contact Google&rsquo;s legal department. Here is the <a href="https://issuetracker.google.com/issues/112448138">issue ticket</a>.</p>
<p><img src="/img/you-are-kindly-advised-to-contact-googles-legal-department.png" alt="You are kindly advised to contact Google&rsquo;s legal department"></p>
<p>Dear Google, when people create a network in a chosen region, they expect the public IPs of the network to be in that region. Let&rsquo;s take the GDPR thing as an example. You set up a service in Europe region, but a geolocation lookup of the service IP shows it is in the US. Even though the service is indeed running in Europe region, you are gonna need some effort to convince your customers that there should be no trace that the data is going out of Europe.</p>
<p>I can tell another issue caused by this &ldquo;feature&rdquo;. A few days ago, a friend of mine encountered a weird challenge. They have servers running on Google Cloud Platform in both Asia and North America, serving Asian and North American customers respectively. Recently they integrated a new third party service (let&rsquo;s call it TPS) to their backend services. This TPS is claimed to have replicas running in both Asia and North America. So requests originating from Asia should be hitting the TPS replica in Asia, and requests originating from North America should be hitting the TPS replica in North America. Out of expectation, all requests were going to the TPS replica in North America. This adds about 200ms extra latency to every customer request!</p>
<p><img src="/img/unexpected-traffic-routing.png" alt="Unexpected traffic routing"></p>
<p>And there are other people facing the same issue.</p>
<p><a href="https://stackoverflow.com/questions/58108523/outgoing-http-request-location-on-google-app-engine">This Stackoverflow user</a> migrated his service from DigitalOcean to GCP and the service didn&rsquo;t work healthily, because &ldquo;a third-party API only accepts requests coming from Brazil&rdquo;.</p>
<p><a href="https://stackoverflow.com/questions/51801691/created-gce-in-europe-region-but-ip-address-shows-its-in-us">This Stackoverflow user</a> gave up using GCP and turned to Azure, because &ldquo;they have strict guideline not to transmit data out of Europe region and they couldn&rsquo;t prove to customers that their service is actually in Europe not in US&rdquo;.</p>
<p>Nowadays lots of existing infrastructure (firewalls, CDNs, etc) and services rely on IP geolocation. The &ldquo;all IPs sharing same geolocation feature&rdquo; for sure fools them all.</p>
<p>And I&rsquo;m waiting for more victims.</p>

			</div>

			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://yuankun.me/tags/gcp">gcp</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>379 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-03-22 23:12 &#43;0800</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="https://github.com/yuankunzhang/blog/commit/09a04a370ee3341d80db3dad2dc0b2cecbae30d9" target="_blank" rel="noopener">09a04a3</a> @ 2020-03-24</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="prev-post" href="https://yuankun.me/posts/debug-linux-kernel-with-qemu-and-gdb/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Debug Linux Kernel With QEMU and GDB</span>
			</a>
		</div>
		<div id="comments" class="thin"><script src="https://utteranc.es/client.js"
        repo="yuankunzhang/blog"
        issue-term="pathname"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2020 <a href="https://yuankun.me/">Yuankun Zhang</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://yuankun.me/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>



	<script src="https://yuankun.me/js/bundle.min.4a9a0ac3d2217822c7865b4161e6c2a71de1d70492264337755427898dd718f6.js" integrity="sha256-SpoKw9IheCLHhltBYebCpx3h1wSSJkM3dVQniY3XGPY=" crossorigin="anonymous"></script>
	

</body>

</html>
